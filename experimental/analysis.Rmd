---
title: "Analysis"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
theme = theme_minimal()
```

```{r}
data = read_csv("clean_pilot.csv")


data$urgent = factor(data$urgent, levels = seq(0,6))
data$serious = factor(data$serious, levels = seq(0,6))
data$sympathy = factor(data$sympathy, levels = seq(0,6))
data$peace = factor(data$peace, levels = seq(0,6))
data$guilty = factor(data$guilty, levels = seq(0,6))


head(data)
```

```{r}
data %>%
  group_by(cond_sex, cond_metaphor) %>%
  summarise(avg_donation = mean(donation)) %>%
  ggplot() + theme + 
  geom_tile(aes(x = cond_sex, y = cond_metaphor, fill = avg_donation)) +
  labs(x = "Condition: sex", y = "Condition: metaphor", title = "Average donation by Condition", fill = "Avgerage\nDonation")
```


```{r}
ggplot(data) + theme +
  geom_density(aes(donation)) +
  labs(x = "Donation Amount", y = "Density", title = "Donation Amount Distribution") +
  lims(x = c(0,50))

ggplot(data) + theme +
  geom_density(aes(total_time))

ggplot(data) + theme +
  geom_bar(aes(urgent, group=1, y=..prop..)) +
  scale_x_discrete(drop = F) +
  labs(x = "Urgent", y = "Proportion", title = "Urgent Distribution", subtitle = "\"Her situation is urgent.\"")

ggplot(data) + theme +
  geom_bar(aes(serious, group=1, y=..prop..)) +
  scale_x_discrete(drop = F) +
  labs(x = "Serious", y = "Proportion", title = "Serious Distribution", subtitle = "\"Her situation is serious.\"")

ggplot(data) + theme +
  geom_bar(aes(sympathy, group=1, y=..prop..)) +
  scale_x_discrete(drop = F) +
  labs(x = "Sympathy", y = "Proportion", title = "Sympathy Distribution", subtitle = "\"Her situation is one I sympathize with.\"")

ggplot(data) + theme +
  geom_bar(aes(peace, group=1, y=..prop..)) +
  scale_x_discrete(drop = F) +
  labs(x = "Peace", y = "Proportion", title = "Peace Distribution", subtitle = "\"She can make peace with her experience.\"")

ggplot(data) + theme +
  geom_bar(aes(guilty, group=1, y=..prop..)) +
  scale_x_discrete(drop = F) +
  labs(x = "Guilty", y = "Proportion", title = "Guilty Distribution", subtitle = "\"She will feel guilty that she hasnâ€™t done enough if she does not recover.\"")
```

```{r}
ggplot(data) +
  geom_density(aes(donation, color=self_cancer)) +
  lims(x = c(0, 50)) +
  labs(x = "Donation Amount", y = "Density", color = "Self Cancer", title = "Donation Distributions by Education Level")

ggplot(data) +
  geom_density(aes(donation, color=ff_cancer)) +
  lims(x = c(0, 50)) +
  labs(x = "Donation Amount", y = "Density", color = "Friends and Family\nCancer", title = "Donation Distributions by Friends and Family Cancer")

ggplot(data) +
  geom_density(aes(donation, color=gender)) +
  lims(x = c(0, 50)) +
  labs(x = "Donation Amount", y = "Density", color = "Gender", title = "Donation Distributions by Gender")

ggplot(data) +
  geom_density(aes(donation, color=education)) +
  lims(x = c(0, 50)) +
  labs(x = "Donation Amount", y = "Density", color = "Education Level", title = "Donation Distributions by Education Level")

ggplot(data) +
  geom_density(aes(donation, color=socioeconomic)) +
  lims(x = c(0, 50)) +
  labs(x = "Donation Amount", y = "Density", color = "Socioeconomic Level", title = "Donation Distributions by Socioeconomic Level")

ggplot(data) +
  geom_density(aes(donation, color=english)) +
  lims(x = c(0, 50)) +
  labs(x = "Donation Amount", y = "Density", color = "Native English", title = "Donation Distributions by Native English")
```

```{r}
m = lm(donation ~ english, data = data)

summary(m)
```





